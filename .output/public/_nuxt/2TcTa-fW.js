const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./aTa61G_T.js","./CqkleIqs.js","./CQgsVD5f.js"])))=>i.map(i=>d[i]);
import{k as Y,l as W,m as O,v as fe,c as o,o as s,a as e,_ as pe,q as y,s as ee,d as he,t as a,x as V,y as B,F as M,r as R,j as u,z as ge,A as ye,B as be,b as H,C as J,w as z,D as F,E as ke,G as xe,H as A,I as $e}from"./B69wRlQC.js";import{_ as _e,F as Pe}from"./CJLuje3R.js";import{u as te}from"./BOg9quWn.js";import"./MLS9lOPg.js";const we={id:"loading","aria-hidden":"true"},Me={__name:"Loading",props:{loading:{type:Boolean,required:!0}},setup(i){return Y(async()=>{await W();const h=document.getElementById("loading"),d=document.querySelector(".loading-wave");h&&d&&(d.classList.add("active"),await W(),h.classList.add("active"))}),(h,d)=>O((s(),o("div",we,d[0]||(d[0]=[e("div",{class:"loading-wave"},null,-1),e("p",null,"載入中...",-1)]),512)),[[fe,i.loading]])}},Ce={key:0,class:"modal"},De={class:"modal-wrapper"},Ie={class:"model-content"},Te={__name:"Modal",props:{isOpen:Boolean},setup(i){return(h,d)=>i.isOpen?(s(),o("div",Ce,[e("div",De,[e("span",{class:"close",onClick:d[0]||(d[0]=$=>h.$emit("close"))},"×"),e("div",Ie,[ee(h.$slots,"default",{},void 0,!0)])])])):y("",!0)}},Re=pe(Te,[["__scopeId","data-v-e17ff7bf"]]),Le={class:"geo-label","aria-hidden":"true"},Se={class:"figure shrink-0 w-full h-48 lg:w-[200px] lg:h-[200px] *:w-full *:h-full"},Ee=["src","alt"],Ne={class:"p-2"},K={__name:"Card",props:{item:Object},emits:["click"],setup(i,{emit:h}){const $=te().domainUrl,b=h;return(p,g)=>(s(),o("li",{class:"card overflow-hidden rounded-xl bg-white shadow-md max-w-[480px] lg:flex",onClick:g[0]||(g[0]=m=>b("click",i.item))},[e("span",Le,[g[1]||(g[1]=e("svg",{class:"geo-label-icon",role:"presentation","aria-hidden":"true"},[e("use",{href:"#pin"})],-1)),he(" "+a(i.item.Region)+a(i.item.Town),1)]),e("figure",Se,[e("img",{src:i.item.Pictures[0]||`${V($)}/images/default.webp`,alt:i.item.Name},null,8,Ee)]),e("div",Ne,[ee(p.$slots,"default")])]))}},He={key:0},Ae={class:"text-2xl font-bold mb-2"},Oe={class:"model-photos flex"},Ve=["href"],Be=["src","alt","title"],qe={class:"mb-2"},je={key:0,class:"mb-2"},Ue={key:1,class:"mb-2"},ze={class:"mb-2"},Fe={key:1,class:"mb-2"},We={class:"list-disc mb-2"},Ge={key:3},Xe={key:4},Ze={key:5,class:"mb-2"},Qe=["href"],Je={key:1},Ke={__name:"DetailHotel",props:{item:Object},setup(i){const h=i,d=B(()=>h.item??{}),$=d.value.Serviceinfo?d.value.Serviceinfo.split(",").filter(p=>p.trim()!==""):[],b=d.value.Spec?d.value.Spec.split(";").filter(p=>p.trim()!=="").join("、"):"";return(p,g)=>{var m,P,w,v,k,I;return i.item?(s(),o("div",He,[e("h2",Ae,a(i.item.Name),1),e("address",null,a(i.item.Add),1),e("div",Oe,[(s(!0),o(M,null,R(i.item.Pictures,(C,T)=>(s(),o("figure",null,[e("a",{href:C,target:"_blank",rel:"noopener noreferrer"},[(s(),o("img",{key:T,src:C,alt:i.item.PicDescribes[T]||"業主提供的住宿環境照片",title:i.item.PicDescribes[T]||""},null,8,Be))],8,Ve)]))),256))]),e("p",qe,a(i.item.Description||""),1),(m=i.item)!=null&&m.LowestPrice?(s(),o(M,{key:0},[i.item.LowestPrice===i.item.CeilingPrice?(s(),o("p",je,"價位："+a(i.item.CeilingPrice)+" 元。",1)):(s(),o("p",Ue,"價位："+a(i.item.LowestPrice)+" ~ "+a(i.item.CeilingPrice)+" 元。",1))],64)):y("",!0),e("p",ze,"房間數："+a((P=i.item)==null?void 0:P.TotalNumberofRooms),1),V(b)?(s(),o("p",Fe,"特殊房型與價格："+a(V(b)),1)):y("",!0),(w=i.item)!=null&&w.Serviceinfo?(s(),o(M,{key:2},[g[0]||(g[0]=e("h3",{class:"text-lg font-bold"},"服務：",-1)),e("ul",We,[(s(!0),o(M,null,R(V($),(C,T)=>(s(),o("li",{key:T},a(C),1))),128))])],64)):y("",!0),(v=i.item)!=null&&v.Tel?(s(),o("p",Ge,"電話："+a(i.item.Tel),1)):y("",!0),(k=i.item)!=null&&k.IndustryEmail?(s(),o("p",Xe,"Email："+a(i.item.IndustryEmail),1)):y("",!0),(I=i.item)!=null&&I.Website?(s(),o("p",Ze,[e("a",{href:i.item.Website,target:"_blank",rel:"noopener noreferrer"},"網站",8,Qe)])):y("",!0)])):(s(),o("div",Je,g[1]||(g[1]=[e("p",null,"沒有資料",-1)])))}}},Ye={key:0},et={class:"text-2xl font-bold mb-2"},tt={class:"model-photos flex"},it=["href"],nt=["src","alt","title"],st={class:"mb-2"},lt={key:0,class:"mb-2"},ot={key:1,class:"mb-2"},at={key:2,class:"mb-2"},rt={key:3,class:"mb-2"},ct={key:4,class:"mb-2"},ut={key:5,class:"mb-2"},dt=["href"],mt={key:6,class:"mb-2"},vt={key:1},ft={__name:"DetailScenic",props:{item:Object},setup(i){return(h,d)=>{var $,b,p,g,m,P,w;return i.item?(s(),o("div",Ye,[e("h2",et,a(i.item.Name),1),e("address",null,a(i.item.Add),1),e("div",tt,[(s(!0),o(M,null,R(i.item.Pictures,(v,k)=>(s(),o("figure",null,[e("a",{href:v,target:"_blank",rel:"noopener noreferrer"},[(s(),o("img",{key:k,src:v,alt:i.item.PicDescribes[k]||i.item.Name,title:i.item.PicDescribes[k]||""},null,8,nt))],8,it)]))),256))]),e("p",st,a(i.item.Toldescribe||""),1),($=i.item)!=null&&$.Opentime?(s(),o("p",lt,"開放時間："+a(i.item.Opentime),1)):y("",!0),(b=i.item)!=null&&b.Ticketinfo?(s(),o("p",ot,"入場費："+a(i.item.Ticketinfo),1)):y("",!0),(p=i.item)!=null&&p.Travellinginfo?(s(),o("p",at,"大眾交通資訊："+a(i.item.Travellinginfo),1)):y("",!0),(g=i.item)!=null&&g.Parkinginfo?(s(),o("p",rt,"停車資訊："+a(i.item.Parkinginfo),1)):y("",!0),(m=i.item)!=null&&m.Tel?(s(),o("p",ct,"電話："+a(i.item.Tel),1)):y("",!0),(P=i.item)!=null&&P.Website?(s(),o("p",ut,[e("a",{href:i.item.Website,target:"_blank",rel:"noopener noreferrer"},"官方網站",8,dt)])):y("",!0),(w=i.item)!=null&&w.Remarks?(s(),o("p",mt,"注意事項："+a(i.item.Remarks),1)):y("",!0)])):(s(),o("div",vt,d[0]||(d[0]=[e("p",null,"沒有資料",-1)])))}}},pt={class:"text-center pb-5"},ht={key:0,id:"hotel-area",class:"pt-5"},gt={class:"text-center mb-5"},yt={for:"city-select",class:"bg-violet-100 text-violet-800 text-xl px-5 py-2 rounded-full"},bt=["value"],kt={class:"grid justify-self-center grid-cols-1 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 2xl:grid-cols-3 gap-4"},xt={class:"title text-2xl font-bold mb-2"},$t={class:"min-h-[48px]"},_t=["innerHTML"],Pt={key:1,id:"scenic-area",class:"pt-5"},wt={class:"text-center mb-5"},Mt={for:"scenic-city-select",class:"bg-violet-100 text-violet-800 text-xl px-5 py-2 rounded-full"},Ct=["value"],Dt={class:"grid justify-self-center grid-cols-1 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 2xl:grid-cols-3 gap-4"},It={class:"title text-xl font-bold mb-2"},Tt={class:"text-2xl"},Rt={class:"range-wrap",style:{"--min":"5","--max":"20","--val":"10"}},Lt={for:"range-input"},St={id:"description"},Vt={__name:"index",setup(i){const h=te(),d=h.domainUrl;u("台灣住宿與景點資訊"),u("根據政府提供的資訊，從景點附近整理出台灣各地的民宿、旅店、旅館。");const $=u([]),b=u([]),p=u([]),g=u(!0),m=u(""),P=u([]),w=u(!0);u(null),u(null);const v=u(null),k=u("");u([]);const I=u([]),C=u(10),T=u([]),L=u(!0),ie=u(!0),S=u({iconUrl:`${d}/images/taiwan/home.svg`,iconSize:[27,24],iconAnchor:[14,14]}),E=u({iconUrl:`${d}/images/taiwan/pin.svg`,iconSize:[21,28],iconAnchor:[10,18]});let _,f;const q=ge(),ne=be(),se=B(()=>m.value?b.value.filter(l=>l.Region===m.value):$.value),le=B(()=>w.value?$.value.slice(0,15):se.value),oe=B(()=>m.value?p.value.filter(l=>l.Region===m.value):p.value.slice(0,15));function ae(){L.value=!L.value,m.value||(w.value=!0)}function G(l,n){let t=l.length,c,x;for(;t;)x=Math.floor(re(n)*t--),c=l[t],l[t]=l[x],l[x]=c,++n;return l}function re(l){const n=Math.sin(l)*1e4;return n-Math.floor(n)}function ce(l,n,t,c){const r=(t-l)*Math.PI/180,D=(c-n)*Math.PI/180,U=Math.sin(r/2)*Math.sin(r/2)+Math.cos(l*Math.PI/180)*Math.cos(t*Math.PI/180)*Math.sin(D/2)*Math.sin(D/2);return 6371*(2*Math.atan2(Math.sqrt(U),Math.sqrt(1-U)))}function X(){if(!v.value)return;const n=k.value==="hotel"?p.value:b.value;I.value=n.filter(t=>ce(v.value.Py,v.value.Px,t.Py,t.Px)<=C.value),T.value=I.value.map(t=>[t.Py,t.Px,{name:t.Name}]),me()}function Z(l,n){v.value=l,k.value=n,X(),W(()=>{de(l.Py,l.Px)})}function ue(){v.value=null}async function de(l,n){f||(f=await A(()=>import("./aTa61G_T.js").then(D=>D.l),__vite__mapDeps([0,1]),import.meta.url).then(D=>D.default)),await A(()=>import("./CQgsVD5f.js").then(D=>D.l),__vite__mapDeps([2,1]),import.meta.url),_&&_.remove();const t=k.value==="hotel",c=t?f.icon(S.value):f.icon(E.value),x=t?f.icon(E.value):f.icon(S.value);_=f.map("map").setView([l,n],13),f.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{minZoom:10,maxZoom:18,attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(_),f.marker([l,n],{icon:c}).addTo(_).bindPopup(v.value.Name).openPopup(),Q(x,t)}async function me(){if(f||(f=await A(()=>import("./aTa61G_T.js").then(c=>c.l),__vite__mapDeps([0,1]),import.meta.url).then(c=>c.default)),await A(()=>import("./CQgsVD5f.js").then(c=>c.l),__vite__mapDeps([2,1]),import.meta.url),!_||(_.eachLayer(c=>{c instanceof f.Marker&&_.removeLayer(c)}),!v.value))return;const l=k.value==="hotel",n=l?f.icon(S.value):f.icon(E.value),t=l?f.icon(E.value):f.icon(S.value);f.marker([v.value.Py,v.value.Px],{icon:n}).addTo(_).bindPopup(v.value.Name).openPopup(),Q(t,l)}function Q(l,n){if(!_||!I.value.length)return;const t=f.markerClusterGroup();I.value.forEach(c=>{const x=f.marker([c.Py,c.Px],{icon:l});x.on("click",()=>{const r=document.querySelector("#description");r&&$e(n?ft:Ke,{item:c}).mount(r)}),t.addLayer(x)}),_.addLayer(t)}Y(async()=>{try{const n=await(await fetch(`${h.api.hotel}`)).json();b.value=n.XML_Head.Infos.Info.map(r=>({...r,Region:r.Region===null?r.Add.slice(0,3):r.Region,Pictures:[r.Picture1,r.Picture2,r.Picture3].filter(Boolean),PicDescribes:[r.Picdescribe1,r.Picdescribe2,r.Picdescribe3].filter(Boolean)}));const c=await(await fetch(`${h.api.scenic}`)).json();p.value=c.XML_Head.Infos.Info.map(r=>({...r,Region:r.Region===null?r.Add.slice(0,3):r.Region,Pictures:[r.Picture1,r.Picture2,r.Picture3].filter(Boolean),PicDescribes:[r.Picdescribe1,r.Picdescribe2,r.Picdescribe3].filter(Boolean)}));const x=new Date().getDate();$.value=G([...b.value],x),p.value=G([...p.value],x),P.value=[...new Set(b.value.map(r=>r.Region))],q.query.city&&(P.value.includes(q.query.city)?(m.value=q.query.city,w.value=!1):(m.value="",N()))}catch(l){console.error("Error fetching data:",l)}finally{setTimeout(()=>{g.value=!1},1600)}}),ye(m,l=>{w.value=!1,N()});function N(){ne.push({query:{city:m.value||void 0}})}const j=l=>l<3e3?"text-emerald-500":l>9e3?"text-pink-700":"",ve=l=>{const{LowestPrice:n,CeilingPrice:t}=l;return`價位：${n===t?`<span class="${j(t)}">${t}</span>`:`<span class="${j(n)}">${n}</span> ~ <span class="${j(t)}">${t}</span>`}。`};return(l,n)=>(s(),o(M,null,[e("div",null,[H(_e),e("main",null,[n[8]||(n[8]=e("h1",{class:"text-center py-[5rem] text-cyan-500 text-4xl"},"找住宿？找景點？",-1)),e("div",pt,[e("button",{class:"bg-violet-700 text-violet-50 text-2xl px-5 py-3 min-w-80 rounded-full cursor-pointer",type:"button",onClick:ae},a(L.value?"改用景點找住宿地點":"改用旅宿找附近景點"),1)]),L.value?(s(),o("div",ht,[e("div",gt,[e("label",yt,[O(e("select",{class:"city-select",id:"city-select","onUpdate:modelValue":n[0]||(n[0]=t=>m.value=t),onChange:N},[n[3]||(n[3]=e("option",{value:"",disabled:"",selected:""},"選擇縣市",-1)),n[4]||(n[4]=e("option",{value:""},"全部",-1)),(s(!0),o(M,null,R(P.value,t=>(s(),o("option",{key:t,value:t},a(t),9,bt))),128))],544),[[J,m.value]])])]),e("div",null,[e("ul",kt,[(s(!0),o(M,null,R(le.value,t=>(s(),F(K,{key:t.Id,item:t,onClick:c=>Z(t,"hotel")},{default:z(()=>[e("div",xt,a(t.Name),1),e("p",$t,a(t.Add),1),e("ul",null,[e("li",null,"共有 "+a(t.TotalNumberofRooms)+" 間房間。",1),e("li",{innerHTML:ve(t)},null,8,_t)])]),_:2},1032,["item","onClick"]))),128))])])])):(s(),o("div",Pt,[e("div",wt,[e("label",Mt,[O(e("select",{class:"city-select",id:"scenic-city-select","onUpdate:modelValue":n[1]||(n[1]=t=>m.value=t),onChange:N},[n[5]||(n[5]=e("option",{value:"",disabled:"",selected:""},"選擇縣市",-1)),n[6]||(n[6]=e("option",{value:""},"全部",-1)),(s(!0),o(M,null,R(P.value,t=>(s(),o("option",{key:t,value:t},a(t),9,Ct))),128))],544),[[J,m.value]])])]),e("div",null,[e("ul",Dt,[(s(!0),o(M,null,R(oe.value,t=>(s(),F(K,{key:t.Id,item:t,onClick:c=>Z(t,"scenic")},{default:z(()=>[e("div",It,a(t.Name),1),n[7]||(n[7]=e("p",{class:"min-h-[48px]"},null,-1))]),_:2},1032,["item","onClick"]))),128))])])]))]),H(Pe)]),H(Re,{isOpen:!!v.value,onClose:ue},{default:z(()=>{var t;return[e("h2",Tt,a((t=v.value)==null?void 0:t.Name),1),e("div",Rt,[O(e("input",{id:"range-input",type:"range",min:"5",max:"20",list:"dl","onUpdate:modelValue":n[2]||(n[2]=c=>C.value=c),onInput:X},null,544),[[ke,C.value]]),n[9]||(n[9]=e("output",{for:"range-input"},"10",-1)),e("label",Lt,"方圓 "+a(C.value)+" 公里內的"+a(k.value==="hotel"?"景點":"旅宿"),1)]),n[10]||(n[10]=e("div",{id:"map-wrapper"},[e("div",{id:"map"})],-1)),e("div",St,[(s(),F(xe(ie.value?"DetailHotel":"DetailScenic"),{item:v.value},null,8,["item"]))])]}),_:1},8,["isOpen"]),H(Me,{loading:g.value},null,8,["loading"])],64))}};export{Vt as default};
