const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./aTa61G_T.js","./CqkleIqs.js","./CQgsVD5f.js"])))=>i.map(i=>d[i]);
import{l as fe,m as pe,q as ge,s as he,k as Q,v as F,x as H,y as ye,c as o,o as s,a as e,_ as be,z as b,A as Y,d as _e,t as a,B as O,C as V,F as M,r as I,j as u,D as xe,E as ke,G as $e,b as A,H as J,w as U,I as z,J as Pe,K as we,L as E,M as Ce}from"./BOWdxeZa.js";import{_ as Me,F as Le}from"./3vPrZFRG.js";import"./B2maQBg2.js";const De=fe({foo:"bar",domainUrl:"https://cjzopen.github.io/trip-inn",theme:{primaryColor:"#ababab"},api:{scenic:"https://media.taiwan.net.tw/XMLReleaseALL_public/scenic_spot_C_f.json",hotel:"https://media.taiwan.net.tw/XMLReleaseALL_public/hotel_C_f.json"}}),Ie={nuxt:{}},Re=pe(De,Ie);function ee(){const t=ge();return t._appConfig||(t._appConfig=he(Re)),t._appConfig}const Te={id:"loading","aria-hidden":"true"},Se={__name:"Loading",props:{loading:{type:Boolean,required:!0}},setup(t){return Q(async()=>{await F();const g=document.getElementById("loading"),d=document.querySelector(".loading-wave");g&&d&&(d.classList.add("active"),await F(),g.classList.add("active"))}),(g,d)=>H((s(),o("div",Te,d[0]||(d[0]=[e("div",{class:"loading-wave"},null,-1),e("p",null,"載入中...",-1)]),512)),[[ye,t.loading]])}},Ne={key:0,class:"modal"},Ae={class:"modal-wrapper"},Ee={class:"model-content"},He={__name:"Modal",props:{isOpen:Boolean},setup(t){return(g,d)=>t.isOpen?(s(),o("div",Ne,[e("div",Ae,[e("span",{class:"close",onClick:d[0]||(d[0]=k=>g.$emit("close"))},"×"),e("div",Ee,[Y(g.$slots,"default",{},void 0,!0)])])])):b("",!0)}},Oe=be(He,[["__scopeId","data-v-e17ff7bf"]]),Ve={class:"geo-label","aria-hidden":"true"},je={class:"figure shrink-0 w-full h-48 lg:w-[200px] lg:h-[200px] *:w-full *:h-full"},Be=["src","alt"],qe={class:"p-2"},K={__name:"Card",props:{item:Object},emits:["click"],setup(t,{emit:g}){const k=ee().domainUrl,y=g;return(p,h)=>(s(),o("li",{class:"card overflow-hidden rounded-xl bg-white shadow-md max-w-[480px] lg:flex",onClick:h[0]||(h[0]=m=>y("click",t.item))},[e("span",Ve,[h[1]||(h[1]=e("svg",{class:"geo-label-icon",role:"presentation","aria-hidden":"true"},[e("use",{href:"#pin"})],-1)),_e(" "+a(t.item.Region),1)]),e("figure",je,[e("img",{src:t.item.Pictures[0]||`${O(k)}/images/default.webp`,alt:t.item.Name},null,8,Be)]),e("div",qe,[Y(p.$slots,"default")])]))}},Ue={key:0},ze={class:"text-2xl font-bold mb-2"},Fe={class:"model-photos flex"},Xe=["href"],Ge=["src","alt","title"],We={class:"mb-2"},Ze={key:0,class:"mb-2"},Je={key:1,class:"mb-2"},Ke={class:"mb-2"},Qe={key:1,class:"mb-2"},Ye={class:"list-disc mb-2"},et={key:3},tt={key:4},it={key:1},nt={__name:"DetailHotel",props:{item:Object},setup(t){const g=t,d=V(()=>g.item??{}),k=d.value.Serviceinfo?d.value.Serviceinfo.split(",").filter(p=>p.trim()!==""):[],y=d.value.Spec?d.value.Spec.split(";").filter(p=>p.trim()!=="").join("、"):"";return(p,h)=>{var m,P,w,v,_;return t.item?(s(),o("div",Ue,[e("h2",ze,a(t.item.Name),1),e("address",null,a(t.item.Add),1),e("div",Fe,[(s(!0),o(M,null,I(t.item.Pictures,(L,C)=>(s(),o("figure",null,[e("a",{href:L,target:"_blank",rel:"noopener noreferrer"},[(s(),o("img",{key:C,src:L,alt:t.item.PicDescribes[C]||"業主提供的住宿環境照片",title:t.item.PicDescribes[C]||""},null,8,Ge))],8,Xe)]))),256))]),e("p",We,a(t.item.Description||""),1),(m=t.item)!=null&&m.LowestPrice?(s(),o(M,{key:0},[t.item.LowestPrice===t.item.CeilingPrice?(s(),o("p",Ze,"價位："+a(t.item.CeilingPrice)+" 元。",1)):(s(),o("p",Je,"價位："+a(t.item.LowestPrice)+" ~ "+a(t.item.CeilingPrice)+" 元。",1))],64)):b("",!0),e("p",Ke,"房間數："+a((P=t.item)==null?void 0:P.TotalNumberofRooms),1),O(y)?(s(),o("p",Qe,"特殊房型與價格："+a(O(y)),1)):b("",!0),(w=t.item)!=null&&w.Serviceinfo?(s(),o(M,{key:2},[h[0]||(h[0]=e("h3",{class:"text-lg font-bold"},"服務：",-1)),e("ul",Ye,[(s(!0),o(M,null,I(O(k),(L,C)=>(s(),o("li",{key:C},a(L),1))),128))])],64)):b("",!0),(v=t.item)!=null&&v.Tel?(s(),o("p",et,"電話："+a(t.item.Tel),1)):b("",!0),(_=t.item)!=null&&_.IndustryEmail?(s(),o("p",tt,"Email："+a(t.item.IndustryEmail),1)):b("",!0)])):(s(),o("div",it,h[1]||(h[1]=[e("p",null,"沒有資料",-1)])))}}},st={key:0},lt={class:"text-2xl font-bold mb-2"},ot={class:"model-photos flex"},at=["href"],ct=["src","alt","title"],rt={class:"mb-2"},ut={key:0,class:"mb-2"},dt={key:1,class:"mb-2"},mt={key:2,class:"mb-2"},vt={key:3,class:"mb-2"},ft={key:4,class:"mb-2"},pt={key:5,class:"mb-2"},gt=["href"],ht={key:6,class:"mb-2"},yt={key:1},bt={__name:"DetailScenic",props:{item:Object},setup(t){return(g,d)=>{var k,y,p,h,m,P,w;return t.item?(s(),o("div",st,[e("h2",lt,a(t.item.Name),1),e("address",null,a(t.item.Add),1),e("div",ot,[(s(!0),o(M,null,I(t.item.Pictures,(v,_)=>(s(),o("figure",null,[e("a",{href:v,target:"_blank",rel:"noopener noreferrer"},[(s(),o("img",{key:_,src:v,alt:t.item.PicDescribes[_]||t.item.Name,title:t.item.PicDescribes[_]||""},null,8,ct))],8,at)]))),256))]),e("p",rt,a(t.item.Toldescribe||""),1),(k=t.item)!=null&&k.Opentime?(s(),o("p",ut,"開放時間："+a(t.item.Opentime),1)):b("",!0),(y=t.item)!=null&&y.Ticketinfo?(s(),o("p",dt,"入場費："+a(t.item.Ticketinfo),1)):b("",!0),(p=t.item)!=null&&p.Travellinginfo?(s(),o("p",mt,"大眾交通資訊："+a(t.item.Travellinginfo),1)):b("",!0),(h=t.item)!=null&&h.Parkinginfo?(s(),o("p",vt,"停車資訊："+a(t.item.Parkinginfo),1)):b("",!0),(m=t.item)!=null&&m.Tel?(s(),o("p",ft,"電話："+a(t.item.Tel),1)):b("",!0),(P=t.item)!=null&&P.Website?(s(),o("p",pt,[e("a",{href:t.item.Website,target:"_blank",rel:"noopener noreferrer"},"官方網站",8,gt)])):b("",!0),(w=t.item)!=null&&w.Remarks?(s(),o("p",ht,"注意事項："+a(t.item.Remarks),1)):b("",!0)])):(s(),o("div",yt,d[0]||(d[0]=[e("p",null,"沒有資料",-1)])))}}},_t={class:"text-center pb-5"},xt={key:0,id:"hotel-area",class:"pt-5"},kt={class:"text-center mb-5"},$t={for:"city-select",class:"bg-violet-100 text-violet-800 text-xl px-5 py-2 rounded-full"},Pt=["value"],wt={class:"grid justify-self-center grid-cols-1 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 2xl:grid-cols-3 gap-4"},Ct={class:"title text-2xl font-bold mb-2"},Mt={class:"min-h-[48px]"},Lt=["innerHTML"],Dt={key:1,id:"scenic-area",class:"pt-5"},It={class:"text-center mb-5"},Rt={for:"scenic-city-select",class:"bg-violet-100 text-violet-800 text-xl px-5 py-2 rounded-full"},Tt=["value"],St={class:"grid justify-self-center grid-cols-1 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 2xl:grid-cols-3 gap-4"},Nt={class:"title text-xl font-bold mb-2"},At={class:"text-2xl"},Et={class:"range-wrap",style:{"--min":"5","--max":"20","--val":"10"}},Ht={for:"range-input"},Ot={id:"description"},Ut={__name:"index",setup(t){const g=ee(),d=g.domainUrl;u("台灣住宿與景點資訊"),u("根據政府提供的資訊，從景點附近整理出台灣各地的民宿、旅店、旅館。");const k=u([]),y=u([]),p=u([]),h=u(!0),m=u(""),P=u([]),w=u(!0);u(null),u(null);const v=u(null),_=u("");u([]);const L=u([]),C=u(10),te=u([]),R=u(!0),ie=u(!0),T=u({iconUrl:`${d}/images/taiwan/home.svg`,iconSize:[27,24],iconAnchor:[14,14]}),S=u({iconUrl:`${d}/images/taiwan/pin.svg`,iconSize:[21,28],iconAnchor:[10,18]});let $,f;const j=xe(),ne=$e(),se=V(()=>m.value?y.value.filter(l=>l.Region===m.value):k.value),le=V(()=>w.value?k.value.slice(0,15):se.value),oe=V(()=>m.value?p.value.filter(l=>l.Region===m.value):p.value.slice(0,15));function ae(){R.value=!R.value,m.value||(w.value=!0)}function X(l,n){let i=l.length,r,x;for(;i;)x=Math.floor(ce(n)*i--),r=l[i],l[i]=l[x],l[x]=r,++n;return l}function ce(l){const n=Math.sin(l)*1e4;return n-Math.floor(n)}function re(l,n,i,r){const c=(i-l)*Math.PI/180,D=(r-n)*Math.PI/180,q=Math.sin(c/2)*Math.sin(c/2)+Math.cos(l*Math.PI/180)*Math.cos(i*Math.PI/180)*Math.sin(D/2)*Math.sin(D/2);return 6371*(2*Math.atan2(Math.sqrt(q),Math.sqrt(1-q)))}function G(){if(!v.value)return;const n=_.value==="hotel"?p.value:y.value;L.value=n.filter(i=>re(v.value.Py,v.value.Px,i.Py,i.Px)<=C.value),te.value=L.value.map(i=>[i.Py,i.Px,{name:i.Name}]),me()}function W(l,n){v.value=l,_.value=n,G(),F(()=>{de(l.Py,l.Px)})}function ue(){v.value=null}async function de(l,n){f||(f=await E(()=>import("./aTa61G_T.js").then(D=>D.l),__vite__mapDeps([0,1]),import.meta.url).then(D=>D.default)),await E(()=>import("./CQgsVD5f.js").then(D=>D.l),__vite__mapDeps([2,1]),import.meta.url),$&&$.remove();const i=_.value==="hotel",r=i?f.icon(T.value):f.icon(S.value),x=i?f.icon(S.value):f.icon(T.value);$=f.map("map").setView([l,n],13),f.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{minZoom:10,maxZoom:18,attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo($),f.marker([l,n],{icon:r}).addTo($).bindPopup(v.value.Name).openPopup(),Z(x,i)}async function me(){if(f||(f=await E(()=>import("./aTa61G_T.js").then(r=>r.l),__vite__mapDeps([0,1]),import.meta.url).then(r=>r.default)),await E(()=>import("./CQgsVD5f.js").then(r=>r.l),__vite__mapDeps([2,1]),import.meta.url),!$||($.eachLayer(r=>{r instanceof f.Marker&&$.removeLayer(r)}),!v.value))return;const l=_.value==="hotel",n=l?f.icon(T.value):f.icon(S.value),i=l?f.icon(S.value):f.icon(T.value);f.marker([v.value.Py,v.value.Px],{icon:n}).addTo($).bindPopup(v.value.Name).openPopup(),Z(i,l)}function Z(l,n){if(!$||!L.value.length)return;const i=f.markerClusterGroup();L.value.forEach(r=>{const x=f.marker([r.Py,r.Px],{icon:l});x.on("click",()=>{const c=document.querySelector("#description");c&&Ce(n?bt:nt,{item:r}).mount(c)}),i.addLayer(x)}),$.addLayer(i)}Q(async()=>{try{const n=await(await fetch(`${g.api.hotel}`)).json();y.value=n.XML_Head.Infos.Info.map(c=>({...c,Region:c.Region===null?c.Add.slice(0,3):c.Region,Pictures:[c.Picture1,c.Picture2,c.Picture3].filter(Boolean),PicDescribes:[c.Picdescribe1,c.Picdescribe2,c.Picdescribe3].filter(Boolean)}));const r=await(await fetch(`${g.api.scenic}`)).json();p.value=r.XML_Head.Infos.Info.map(c=>({...c,Region:c.Region===null?c.Add.slice(0,3):c.Region,Pictures:[c.Picture1,c.Picture2,c.Picture3].filter(Boolean),PicDescribes:[c.Picdescribe1,c.Picdescribe2,c.Picdescribe3].filter(Boolean)}));const x=new Date().getDate();k.value=X([...y.value],x),p.value=X([...p.value],x),P.value=[...new Set(y.value.map(c=>c.Region))],j.query.city&&(P.value.includes(j.query.city)?(m.value=j.query.city,w.value=!1):(m.value="",N()))}catch(l){console.error("Error fetching data:",l)}finally{setTimeout(()=>{h.value=!1},1600)}}),ke(m,l=>{w.value=!1,N()});function N(){ne.push({query:{city:m.value||void 0}})}const B=l=>l<3e3?"text-emerald-500":l>9e3?"text-pink-700":"",ve=l=>{const{LowestPrice:n,CeilingPrice:i}=l;return`價位：${n===i?`<span class="${B(i)}">${i}</span>`:`<span class="${B(n)}">${n}</span> ~ <span class="${B(i)}">${i}</span>`}。`};return(l,n)=>(s(),o(M,null,[e("div",null,[A(Me),e("main",null,[n[8]||(n[8]=e("h1",{class:"text-center py-[5rem] text-cyan-500 text-4xl"},"找住宿？找景點？",-1)),e("div",_t,[e("button",{class:"bg-violet-700 text-violet-50 text-2xl px-5 py-3 min-w-80 rounded-full cursor-pointer",type:"button",onClick:ae},a(R.value?"改用景點找住宿地點":"改用旅宿找附近景點"),1)]),R.value?(s(),o("div",xt,[e("div",kt,[e("label",$t,[H(e("select",{class:"city-select",id:"city-select","onUpdate:modelValue":n[0]||(n[0]=i=>m.value=i),onChange:N},[n[3]||(n[3]=e("option",{value:"",disabled:"",selected:""},"選擇縣市",-1)),n[4]||(n[4]=e("option",{value:""},"全部",-1)),(s(!0),o(M,null,I(P.value,i=>(s(),o("option",{key:i,value:i},a(i),9,Pt))),128))],544),[[J,m.value]])])]),e("div",null,[e("ul",wt,[(s(!0),o(M,null,I(le.value,i=>(s(),z(K,{key:i.Id,item:i,onClick:r=>W(i,"hotel")},{default:U(()=>[e("div",Ct,a(i.Name),1),e("p",Mt,a(i.Add),1),e("ul",null,[e("li",null,"共有 "+a(i.TotalNumberofRooms)+" 間房間。",1),e("li",{innerHTML:ve(i)},null,8,Lt)])]),_:2},1032,["item","onClick"]))),128))])])])):(s(),o("div",Dt,[e("div",It,[e("label",Rt,[H(e("select",{class:"city-select",id:"scenic-city-select","onUpdate:modelValue":n[1]||(n[1]=i=>m.value=i),onChange:N},[n[5]||(n[5]=e("option",{value:"",disabled:"",selected:""},"選擇縣市",-1)),n[6]||(n[6]=e("option",{value:""},"全部",-1)),(s(!0),o(M,null,I(P.value,i=>(s(),o("option",{key:i,value:i},a(i),9,Tt))),128))],544),[[J,m.value]])])]),e("div",null,[e("ul",St,[(s(!0),o(M,null,I(oe.value,i=>(s(),z(K,{key:i.Id,item:i,onClick:r=>W(i,"scenic")},{default:U(()=>[e("div",Nt,a(i.Name),1),n[7]||(n[7]=e("p",{class:"min-h-[48px]"},null,-1))]),_:2},1032,["item","onClick"]))),128))])])]))]),A(Le)]),A(Oe,{isOpen:!!v.value,onClose:ue},{default:U(()=>{var i;return[e("h2",At,a((i=v.value)==null?void 0:i.Name),1),e("div",Et,[H(e("input",{id:"range-input",type:"range",min:"5",max:"20",list:"dl","onUpdate:modelValue":n[2]||(n[2]=r=>C.value=r),onInput:G},null,544),[[Pe,C.value]]),n[9]||(n[9]=e("output",{for:"range-input"},"10",-1)),e("label",Ht,"方圓 "+a(C.value)+" 公里內的"+a(_.value==="hotel"?"景點":"旅宿"),1)]),n[10]||(n[10]=e("div",{id:"map-wrapper"},[e("div",{id:"map"})],-1)),e("div",Ot,[(s(),z(we(ie.value?"DetailHotel":"DetailScenic"),{item:v.value},null,8,["item"]))])]}),_:1},8,["isOpen"]),A(Se,{loading:h.value},null,8,["loading"])],64))}};export{Ut as default};
