const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./aTa61G_T.js","./CqkleIqs.js","./CQgsVD5f.js"])))=>i.map(i=>d[i]);
import{k as K,l as F,m as A,v as fe,c as o,o as s,a as e,_ as pe,q as b,s as Y,d as ge,t as a,x as O,y as V,F as C,r as T,j as u,z as he,A as ye,B as be,b as N,C as Q,w as U,D as z,E as xe,G as _e,H,I as ke}from"./D70o4nLr.js";import{_ as $e,F as Pe}from"./CjguPKxi.js";import{u as ee}from"./tQtB-sQd.js";import"./vQNO8SjI.js";const we={id:"loading","aria-hidden":"true"},Me={__name:"Loading",props:{loading:{type:Boolean,required:!0}},setup(i){return K(async()=>{await F();const g=document.getElementById("loading"),d=document.querySelector(".loading-wave");g&&d&&(d.classList.add("active"),await F(),g.classList.add("active"))}),(g,d)=>A((s(),o("div",we,d[0]||(d[0]=[e("div",{class:"loading-wave"},null,-1),e("p",null,"載入中...",-1)]),512)),[[fe,i.loading]])}},Ce={key:0,class:"modal"},De={class:"modal-wrapper"},Ie={class:"model-content"},Te={__name:"Modal",props:{isOpen:Boolean},setup(i){return(g,d)=>i.isOpen?(s(),o("div",Ce,[e("div",De,[e("span",{class:"close",onClick:d[0]||(d[0]=k=>g.$emit("close"))},"×"),e("div",Ie,[Y(g.$slots,"default",{},void 0,!0)])])])):b("",!0)}},Re=pe(Te,[["__scopeId","data-v-e17ff7bf"]]),Le={class:"geo-label","aria-hidden":"true"},Se={class:"figure shrink-0 w-full h-48 lg:w-[200px] lg:h-[200px] *:w-full *:h-full"},Ee=["src","alt"],Ne={class:"p-2"},J={__name:"Card",props:{item:Object},emits:["click"],setup(i,{emit:g}){const k=ee().domainUrl,y=g;return(p,h)=>(s(),o("li",{class:"card overflow-hidden rounded-xl bg-white shadow-md max-w-[480px] lg:flex",onClick:h[0]||(h[0]=m=>y("click",i.item))},[e("span",Le,[h[1]||(h[1]=e("svg",{class:"geo-label-icon",role:"presentation","aria-hidden":"true"},[e("use",{href:"#pin"})],-1)),ge(" "+a(i.item.Region),1)]),e("figure",Se,[e("img",{src:i.item.Pictures[0]||`${O(k)}/images/default.webp`,alt:i.item.Name},null,8,Ee)]),e("div",Ne,[Y(p.$slots,"default")])]))}},He={key:0},Ae={class:"text-2xl font-bold mb-2"},Oe={class:"model-photos flex"},Ve=["href"],Be=["src","alt","title"],qe={class:"mb-2"},je={key:0,class:"mb-2"},Ue={key:1,class:"mb-2"},ze={class:"mb-2"},Fe={key:1,class:"mb-2"},Ge={class:"list-disc mb-2"},We={key:3},Xe={key:4},Ze={key:1},Qe={__name:"DetailHotel",props:{item:Object},setup(i){const g=i,d=V(()=>g.item??{}),k=d.value.Serviceinfo?d.value.Serviceinfo.split(",").filter(p=>p.trim()!==""):[],y=d.value.Spec?d.value.Spec.split(";").filter(p=>p.trim()!=="").join("、"):"";return(p,h)=>{var m,P,w,v,x;return i.item?(s(),o("div",He,[e("h2",Ae,a(i.item.Name),1),e("address",null,a(i.item.Add),1),e("div",Oe,[(s(!0),o(C,null,T(i.item.Pictures,(D,M)=>(s(),o("figure",null,[e("a",{href:D,target:"_blank",rel:"noopener noreferrer"},[(s(),o("img",{key:M,src:D,alt:i.item.PicDescribes[M]||"業主提供的住宿環境照片",title:i.item.PicDescribes[M]||""},null,8,Be))],8,Ve)]))),256))]),e("p",qe,a(i.item.Description||""),1),(m=i.item)!=null&&m.LowestPrice?(s(),o(C,{key:0},[i.item.LowestPrice===i.item.CeilingPrice?(s(),o("p",je,"價位："+a(i.item.CeilingPrice)+" 元。",1)):(s(),o("p",Ue,"價位："+a(i.item.LowestPrice)+" ~ "+a(i.item.CeilingPrice)+" 元。",1))],64)):b("",!0),e("p",ze,"房間數："+a((P=i.item)==null?void 0:P.TotalNumberofRooms),1),O(y)?(s(),o("p",Fe,"特殊房型與價格："+a(O(y)),1)):b("",!0),(w=i.item)!=null&&w.Serviceinfo?(s(),o(C,{key:2},[h[0]||(h[0]=e("h3",{class:"text-lg font-bold"},"服務：",-1)),e("ul",Ge,[(s(!0),o(C,null,T(O(k),(D,M)=>(s(),o("li",{key:M},a(D),1))),128))])],64)):b("",!0),(v=i.item)!=null&&v.Tel?(s(),o("p",We,"電話："+a(i.item.Tel),1)):b("",!0),(x=i.item)!=null&&x.IndustryEmail?(s(),o("p",Xe,"Email："+a(i.item.IndustryEmail),1)):b("",!0)])):(s(),o("div",Ze,h[1]||(h[1]=[e("p",null,"沒有資料",-1)])))}}},Je={key:0},Ke={class:"text-2xl font-bold mb-2"},Ye={class:"model-photos flex"},et=["href"],tt=["src","alt","title"],it={class:"mb-2"},nt={key:0,class:"mb-2"},st={key:1,class:"mb-2"},lt={key:2,class:"mb-2"},ot={key:3,class:"mb-2"},at={key:4,class:"mb-2"},ct={key:5,class:"mb-2"},rt=["href"],ut={key:6,class:"mb-2"},dt={key:1},mt={__name:"DetailScenic",props:{item:Object},setup(i){return(g,d)=>{var k,y,p,h,m,P,w;return i.item?(s(),o("div",Je,[e("h2",Ke,a(i.item.Name),1),e("address",null,a(i.item.Add),1),e("div",Ye,[(s(!0),o(C,null,T(i.item.Pictures,(v,x)=>(s(),o("figure",null,[e("a",{href:v,target:"_blank",rel:"noopener noreferrer"},[(s(),o("img",{key:x,src:v,alt:i.item.PicDescribes[x]||i.item.Name,title:i.item.PicDescribes[x]||""},null,8,tt))],8,et)]))),256))]),e("p",it,a(i.item.Toldescribe||""),1),(k=i.item)!=null&&k.Opentime?(s(),o("p",nt,"開放時間："+a(i.item.Opentime),1)):b("",!0),(y=i.item)!=null&&y.Ticketinfo?(s(),o("p",st,"入場費："+a(i.item.Ticketinfo),1)):b("",!0),(p=i.item)!=null&&p.Travellinginfo?(s(),o("p",lt,"大眾交通資訊："+a(i.item.Travellinginfo),1)):b("",!0),(h=i.item)!=null&&h.Parkinginfo?(s(),o("p",ot,"停車資訊："+a(i.item.Parkinginfo),1)):b("",!0),(m=i.item)!=null&&m.Tel?(s(),o("p",at,"電話："+a(i.item.Tel),1)):b("",!0),(P=i.item)!=null&&P.Website?(s(),o("p",ct,[e("a",{href:i.item.Website,target:"_blank",rel:"noopener noreferrer"},"官方網站",8,rt)])):b("",!0),(w=i.item)!=null&&w.Remarks?(s(),o("p",ut,"注意事項："+a(i.item.Remarks),1)):b("",!0)])):(s(),o("div",dt,d[0]||(d[0]=[e("p",null,"沒有資料",-1)])))}}},vt={class:"text-center pb-5"},ft={key:0,id:"hotel-area",class:"pt-5"},pt={class:"text-center mb-5"},gt={for:"city-select",class:"bg-violet-100 text-violet-800 text-xl px-5 py-2 rounded-full"},ht=["value"],yt={class:"grid justify-self-center grid-cols-1 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 2xl:grid-cols-3 gap-4"},bt={class:"title text-2xl font-bold mb-2"},xt={class:"min-h-[48px]"},_t=["innerHTML"],kt={key:1,id:"scenic-area",class:"pt-5"},$t={class:"text-center mb-5"},Pt={for:"scenic-city-select",class:"bg-violet-100 text-violet-800 text-xl px-5 py-2 rounded-full"},wt=["value"],Mt={class:"grid justify-self-center grid-cols-1 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-2 2xl:grid-cols-3 gap-4"},Ct={class:"title text-xl font-bold mb-2"},Dt={class:"text-2xl"},It={class:"range-wrap",style:{"--min":"5","--max":"20","--val":"10"}},Tt={for:"range-input"},Rt={id:"description"},At={__name:"index",setup(i){const g=ee(),d=g.domainUrl;u("台灣住宿與景點資訊"),u("根據政府提供的資訊，從景點附近整理出台灣各地的民宿、旅店、旅館。");const k=u([]),y=u([]),p=u([]),h=u(!0),m=u(""),P=u([]),w=u(!0);u(null),u(null);const v=u(null),x=u("");u([]);const D=u([]),M=u(10),te=u([]),R=u(!0),ie=u(!0),L=u({iconUrl:`${d}/images/taiwan/home.svg`,iconSize:[27,24],iconAnchor:[14,14]}),S=u({iconUrl:`${d}/images/taiwan/pin.svg`,iconSize:[21,28],iconAnchor:[10,18]});let $,f;const B=he(),ne=be(),se=V(()=>m.value?y.value.filter(l=>l.Region===m.value):k.value),le=V(()=>w.value?k.value.slice(0,15):se.value),oe=V(()=>m.value?p.value.filter(l=>l.Region===m.value):p.value.slice(0,15));function ae(){R.value=!R.value,m.value||(w.value=!0)}function G(l,n){let t=l.length,r,_;for(;t;)_=Math.floor(ce(n)*t--),r=l[t],l[t]=l[_],l[_]=r,++n;return l}function ce(l){const n=Math.sin(l)*1e4;return n-Math.floor(n)}function re(l,n,t,r){const c=(t-l)*Math.PI/180,I=(r-n)*Math.PI/180,j=Math.sin(c/2)*Math.sin(c/2)+Math.cos(l*Math.PI/180)*Math.cos(t*Math.PI/180)*Math.sin(I/2)*Math.sin(I/2);return 6371*(2*Math.atan2(Math.sqrt(j),Math.sqrt(1-j)))}function W(){if(!v.value)return;const n=x.value==="hotel"?p.value:y.value;D.value=n.filter(t=>re(v.value.Py,v.value.Px,t.Py,t.Px)<=M.value),te.value=D.value.map(t=>[t.Py,t.Px,{name:t.Name}]),me()}function X(l,n){v.value=l,x.value=n,W(),F(()=>{de(l.Py,l.Px)})}function ue(){v.value=null}async function de(l,n){f||(f=await H(()=>import("./aTa61G_T.js").then(I=>I.l),__vite__mapDeps([0,1]),import.meta.url).then(I=>I.default)),await H(()=>import("./CQgsVD5f.js").then(I=>I.l),__vite__mapDeps([2,1]),import.meta.url),$&&$.remove();const t=x.value==="hotel",r=t?f.icon(L.value):f.icon(S.value),_=t?f.icon(S.value):f.icon(L.value);$=f.map("map").setView([l,n],13),f.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{minZoom:10,maxZoom:18,attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo($),f.marker([l,n],{icon:r}).addTo($).bindPopup(v.value.Name).openPopup(),Z(_,t)}async function me(){if(f||(f=await H(()=>import("./aTa61G_T.js").then(r=>r.l),__vite__mapDeps([0,1]),import.meta.url).then(r=>r.default)),await H(()=>import("./CQgsVD5f.js").then(r=>r.l),__vite__mapDeps([2,1]),import.meta.url),!$||($.eachLayer(r=>{r instanceof f.Marker&&$.removeLayer(r)}),!v.value))return;const l=x.value==="hotel",n=l?f.icon(L.value):f.icon(S.value),t=l?f.icon(S.value):f.icon(L.value);f.marker([v.value.Py,v.value.Px],{icon:n}).addTo($).bindPopup(v.value.Name).openPopup(),Z(t,l)}function Z(l,n){if(!$||!D.value.length)return;const t=f.markerClusterGroup();D.value.forEach(r=>{const _=f.marker([r.Py,r.Px],{icon:l});_.on("click",()=>{const c=document.querySelector("#description");c&&ke(n?mt:Qe,{item:r}).mount(c)}),t.addLayer(_)}),$.addLayer(t)}K(async()=>{try{const n=await(await fetch(`${g.api.hotel}`)).json();y.value=n.XML_Head.Infos.Info.map(c=>({...c,Region:c.Region===null?c.Add.slice(0,3):c.Region,Pictures:[c.Picture1,c.Picture2,c.Picture3].filter(Boolean),PicDescribes:[c.Picdescribe1,c.Picdescribe2,c.Picdescribe3].filter(Boolean)}));const r=await(await fetch(`${g.api.scenic}`)).json();p.value=r.XML_Head.Infos.Info.map(c=>({...c,Region:c.Region===null?c.Add.slice(0,3):c.Region,Pictures:[c.Picture1,c.Picture2,c.Picture3].filter(Boolean),PicDescribes:[c.Picdescribe1,c.Picdescribe2,c.Picdescribe3].filter(Boolean)}));const _=new Date().getDate();k.value=G([...y.value],_),p.value=G([...p.value],_),P.value=[...new Set(y.value.map(c=>c.Region))],B.query.city&&(P.value.includes(B.query.city)?(m.value=B.query.city,w.value=!1):(m.value="",E()))}catch(l){console.error("Error fetching data:",l)}finally{setTimeout(()=>{h.value=!1},1600)}}),ye(m,l=>{w.value=!1,E()});function E(){ne.push({query:{city:m.value||void 0}})}const q=l=>l<3e3?"text-emerald-500":l>9e3?"text-pink-700":"",ve=l=>{const{LowestPrice:n,CeilingPrice:t}=l;return`價位：${n===t?`<span class="${q(t)}">${t}</span>`:`<span class="${q(n)}">${n}</span> ~ <span class="${q(t)}">${t}</span>`}。`};return(l,n)=>(s(),o(C,null,[e("div",null,[N($e),e("main",null,[n[8]||(n[8]=e("h1",{class:"text-center py-[5rem] text-cyan-500 text-4xl"},"找住宿？找景點？",-1)),e("div",vt,[e("button",{class:"bg-violet-700 text-violet-50 text-2xl px-5 py-3 min-w-80 rounded-full cursor-pointer",type:"button",onClick:ae},a(R.value?"改用景點找住宿地點":"改用旅宿找附近景點"),1)]),R.value?(s(),o("div",ft,[e("div",pt,[e("label",gt,[A(e("select",{class:"city-select",id:"city-select","onUpdate:modelValue":n[0]||(n[0]=t=>m.value=t),onChange:E},[n[3]||(n[3]=e("option",{value:"",disabled:"",selected:""},"選擇縣市",-1)),n[4]||(n[4]=e("option",{value:""},"全部",-1)),(s(!0),o(C,null,T(P.value,t=>(s(),o("option",{key:t,value:t},a(t),9,ht))),128))],544),[[Q,m.value]])])]),e("div",null,[e("ul",yt,[(s(!0),o(C,null,T(le.value,t=>(s(),z(J,{key:t.Id,item:t,onClick:r=>X(t,"hotel")},{default:U(()=>[e("div",bt,a(t.Name),1),e("p",xt,a(t.Add),1),e("ul",null,[e("li",null,"共有 "+a(t.TotalNumberofRooms)+" 間房間。",1),e("li",{innerHTML:ve(t)},null,8,_t)])]),_:2},1032,["item","onClick"]))),128))])])])):(s(),o("div",kt,[e("div",$t,[e("label",Pt,[A(e("select",{class:"city-select",id:"scenic-city-select","onUpdate:modelValue":n[1]||(n[1]=t=>m.value=t),onChange:E},[n[5]||(n[5]=e("option",{value:"",disabled:"",selected:""},"選擇縣市",-1)),n[6]||(n[6]=e("option",{value:""},"全部",-1)),(s(!0),o(C,null,T(P.value,t=>(s(),o("option",{key:t,value:t},a(t),9,wt))),128))],544),[[Q,m.value]])])]),e("div",null,[e("ul",Mt,[(s(!0),o(C,null,T(oe.value,t=>(s(),z(J,{key:t.Id,item:t,onClick:r=>X(t,"scenic")},{default:U(()=>[e("div",Ct,a(t.Name),1),n[7]||(n[7]=e("p",{class:"min-h-[48px]"},null,-1))]),_:2},1032,["item","onClick"]))),128))])])]))]),N(Pe)]),N(Re,{isOpen:!!v.value,onClose:ue},{default:U(()=>{var t;return[e("h2",Dt,a((t=v.value)==null?void 0:t.Name),1),e("div",It,[A(e("input",{id:"range-input",type:"range",min:"5",max:"20",list:"dl","onUpdate:modelValue":n[2]||(n[2]=r=>M.value=r),onInput:W},null,544),[[xe,M.value]]),n[9]||(n[9]=e("output",{for:"range-input"},"10",-1)),e("label",Tt,"方圓 "+a(M.value)+" 公里內的"+a(x.value==="hotel"?"景點":"旅宿"),1)]),n[10]||(n[10]=e("div",{id:"map-wrapper"},[e("div",{id:"map"})],-1)),e("div",Rt,[(s(),z(_e(ie.value?"DetailHotel":"DetailScenic"),{item:v.value},null,8,["item"]))])]}),_:1},8,["isOpen"]),N(Me,{loading:h.value},null,8,["loading"])],64))}};export{At as default};
